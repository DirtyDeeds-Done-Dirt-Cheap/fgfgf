<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Мои напоминания</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      padding-bottom: 120px;
      transition: background-color 0.3s, color 0.3s;
      background-color: #fff; 
      color: #000;
    }
    h1 {
      margin-bottom: 20px;
    }
    button, select, input {
      font-size: 14px;
      padding: 6px 10px;
      cursor: pointer;
    }
    button.delete {
      background-color: #ff5555;
      color: #fff;
      border: none;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
    }

    #categoriesContainer {
      margin-top: 20px;
    }
    .category-panel {
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      overflow: hidden;
    }
    .category-header {
      margin: 0;
      padding: 10px;
      background-color: #f5f5f5; 
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }
    .category-header h2 {
      margin: 0;
      font-size: 16px;
      transition: color 0.3s;
    }
    .category-content {
      display: none; 
      padding: 10px;
    }
    .reminder-item {
      transition: background-color 0.3s, color 0.3s;
      background-color: #fafafa;
      margin: 8px 0;
      padding: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    /* Кнопка &laquo;Тема&raquo; (правый нижний угол) */
    #themeToggle {
      position: fixed;
      right: 20px;
      bottom: 20px;
      z-index: 9999;
      background-color: #888;
      color: #fff;
      border: none;
    }

    /* Панель &laquo;Тема&raquo; (прокручиваемая) */
    #themePanel {
      position: fixed;
      bottom: 70px;
      right: 20px;
      z-index: 9999;
      background: #eee;
      color: #000;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
      width: 320px;
      display: none;

      max-height: 60vh; 
      overflow-y: auto;
    }
    #themePanel label {
      display: block;
      margin-top: 10px;
    }
    #themePanel h3 {
      margin: 0 0 10px 0;
      font-size: 16px;
    }
    .theme-presets {
      display: flex;
      gap: 5px;
      margin-top: 10px;
    }

    /* Кнопка языка (левый нижний угол) */
    #languageSelect {
      position: fixed;
      left: 20px;
      bottom: 20px;
      z-index: 9999;
      cursor: pointer;
    }

    @media (max-width: 600px) {
      .row {
        flex-direction: column;
        align-items: stretch;
      }
      .row > * {
        flex: 1 1 auto;
      }
      #themeToggle {
        right: 10px;
        bottom: 10px;
      }
      #themePanel {
        right: 10px;
        width: 90%;
      }
      #languageSelect {
        left: 10px;
        bottom: 10px;
      }
    }
  </style>
</head>
<body>

  <h1 id="title">Мои напоминания</h1>

  <!-- Форма добавления напоминания -->
  <div class="row">
    <input type="text" id="reminderText" placeholder="Текст напоминания" />
    <input type="date" id="reminderDate" />
    <input type="time" id="reminderTime" />

    <select id="reminderCategory">
      <option value="Работа">Работа</option>
      <option value="Личное">Личное</option>
      <option value="Учёба">Учёба</option>
    </select>

    <select id="reminderRepeat">
      <option value="none">Без повтора</option>
      <option value="10m">Каждые 10 минут</option>
      <option value="1h">Каждый час</option>
      <option value="1d">Каждый день</option>
      <option value="1w">Раз в неделю</option>
      <option value="1M">Каждый месяц</option>
    </select>

    <button id="addReminder">Добавить</button>
  </div>

  <div id="categoriesContainer"></div>

  <!-- Селект языка (левый нижний угол) -->
  <select id="languageSelect">
    <option value="ru">Рус</option>
    <option value="en">Eng</option>
    <option value="uk">Укр</option>
  </select>

  <!-- Кнопка "Тема" (правый нижний угол) -->
  <button id="themeToggle">Тема</button>

  <!-- Панель настройки темы -->
  <div id="themePanel">
    <h3 id="themeSettingsTitle">Настройка темы</h3>

    <!-- Цвет фона/текста BODY -->
    <label id="labelBodyBgColor">
      Цвет фона страницы:
      <input type="color" id="bodyBgColor" value="#ffffff">
    </label>
    <label id="labelBodyTextColor">
      Цвет текста страницы:
      <input type="color" id="bodyTextColor" value="#000000">
    </label>

    <!-- Форма полей (text, date, time, select) -->
    <label id="labelFieldShape">
      Форма полей ввода / списков:
      <br/>
      <input type="radio" name="fieldShape" value="rect" checked> Прямоугольная
      <br/>
      <input type="radio" name="fieldShape" value="round"> Закруглённая
    </label>

    <!-- Цвет фона/текста полей -->
    <label id="labelTextInputBg">
      Цвет фона поля "Текст напоминания":
      <input type="color" id="textInputBg" value="#ffffff">
    </label>
    <label id="labelTextInputColor">
      Цвет текста поля "Текст напоминания":
      <input type="color" id="textInputColor" value="#000000">
    </label>

    <label id="labelDateInputBg">
      Цвет фона поля "Дата":
      <input type="color" id="dateInputBg" value="#ffffff">
    </label>
    <label id="labelDateInputColor">
      Цвет текста поля "Дата":
      <input type="color" id="dateInputColor" value="#000000">
    </label>

    <label id="labelTimeInputBg">
      Цвет фона поля "Время":
      <input type="color" id="timeInputBg" value="#ffffff">
    </label>
    <label id="labelTimeInputColor">
      Цвет текста поля "Время":
      <input type="color" id="timeInputColor" value="#000000">
    </label>

    <label id="labelCategoryBg">
      Цвет фона поля "Категория":
      <input type="color" id="categoryBg" value="#ffffff">
    </label>
    <label id="labelCategoryColor">
      Цвет текста поля "Категория":
      <input type="color" id="categoryColor" value="#000000">
    </label>

    <label id="labelRepeatBg">
      Цвет фона поля "Повтор":
      <input type="color" id="repeatBg" value="#ffffff">
    </label>
    <label id="labelRepeatColor">
      Цвет текста поля "Повтор":
      <input type="color" id="repeatColor" value="#000000">
    </label>

    <label id="labelLangBg">
      Цвет фона списка "Язык":
      <input type="color" id="langBg" value="#ffffff">
    </label>
    <label id="labelLangColor">
      Цвет текста списка "Язык":
      <input type="color" id="langColor" value="#000000">
    </label>

    <!-- Кнопка &laquo;Добавить&raquo; -->
    <label id="labelAddBtnBgColor">
      Цвет фона кнопки &laquo;Добавить&raquo;:
      <input type="color" id="addBtnBgColor" value="#ffffff">
    </label>
    <label id="labelAddBtnTextColor">
      Цвет текста кнопки &laquo;Добавить&raquo;:
      <input type="color" id="addBtnTextColor" value="#000000">
    </label>
    <div id="labelAddBtnShape">
      Форма кнопки &laquo;Добавить&raquo;:
      <br/>
      <input type="radio" name="addBtnShape" value="rect" checked> Прямоугольная
      <br/>
      <input type="radio" name="addBtnShape" value="round"> Закруглённая
    </div>

    <!-- Кнопка &laquo;Удалить&raquo; -->
    <label id="labelDeleteBtnBgColor">
      Цвет фона кнопки &laquo;Удалить&raquo;:
      <input type="color" id="deleteBtnBgColor" value="#ff5555">
    </label>
    <label id="labelDeleteBtnTextColor">
      Цвет текста кнопки &laquo;Удалить&raquo;:
      <input type="color" id="deleteBtnTextColor" value="#ffffff">
    </label>
    <div id="labelDeleteBtnShape">
      Форма кнопки &laquo;Удалить&raquo;:
      <br/>
      <input type="radio" name="deleteBtnShape" value="rect" checked> Прямоугольная
      <br/>
      <input type="radio" name="deleteBtnShape" value="round"> Закруглённая
    </div>

    <!-- Кнопка &laquo;Тема&raquo; -->
    <label id="labelThemeBtnBgColor">
      Цвет фона кнопки &laquo;Тема&raquo;:
      <input type="color" id="themeBtnBgColor" value="#888888">
    </label>
    <label id="labelThemeBtnTextColor">
      Цвет текста кнопки &laquo;Тема&raquo;:
      <input type="color" id="themeBtnTextColor" value="#ffffff">
    </label>
    <div id="labelThemeBtnShape">
      Форма кнопки &laquo;Тема&raquo;:
      <br/>
      <input type="radio" name="themeBtnShape" value="rect" checked> Прямоугольная
      <br/>
      <input type="radio" name="themeBtnShape" value="round"> Закруглённая
    </div>

    <!-- Настройка .reminder-item -->
    <label id="labelItemBgColor">
      Цвет фона "Напоминания":
      <input type="color" id="itemBgColor" value="#fafafa">
    </label>
    <label id="labelItemTextColor">
      Цвет текста "Напоминания":
      <input type="color" id="itemTextColor" value="#000000">
    </label>

    <!-- Пресеты (Белая / Чёрная) -->
    <div class="theme-presets">
      <button id="whiteThemeButton">Белая тема</button>
      <button id="blackThemeButton">Чёрная тема</button>
    </div>

    <div style="margin-top: 10px;">
      <button id="saveCustomTheme">Применить</button>
      <button id="resetCustomTheme">Сбросить</button>
    </div>
  </div>

  <script>
    /* ======================
       1) ДАННЫЕ
    ====================== */
    let reminders = JSON.parse(localStorage.getItem('reminders')) || [];
    let reminderTimeouts = [];
    let currentLang = localStorage.getItem('language') || 'ru';

    function loadCustomColors() {
      const saved = localStorage.getItem('customColors');
      if (!saved) {
        return {
          bodyBg:"#ffffff",
          bodyText:"#000000",
          fieldShape:"rect",

          textInputBg:"#ffffff", textInputColor:"#000000",
          dateInputBg:"#ffffff", dateInputColor:"#000000",
          timeInputBg:"#ffffff", timeInputColor:"#000000",
          categoryBg:"#ffffff",  categoryColor:"#000000",
          repeatBg:"#ffffff",    repeatColor:"#000000",
          langBg:"#ffffff",      langColor:"#000000",

          addBtnBg:"#ffffff",    addBtnText:"#000000", addBtnShape:"rect",
          deleteBtnBg:"#ff5555", deleteBtnText:"#ffffff", deleteBtnShape:"rect",
          themeBtnBg:"#888888",  themeBtnText:"#ffffff",  themeBtnShape:"rect",

          itemBg:"#fafafa",  // фон блока .reminder-item
          itemText:"#000000" // текст внутри напоминания
        };
      }
      return JSON.parse(saved);
    }
    let customColors = loadCustomColors();
    function saveCustomColors() {
      localStorage.setItem('customColors', JSON.stringify(customColors));
    }

    // Переводы на три языка (ру, en, ук)
    const translations = {
      ru: {
        title:"Мои напоминания",
        placeholderReminder:"Текст напоминания",
        addBtn:"Добавить",
        themeBtn:"Тема",
        repeatNone:"Без повтора",
        every10m:"Каждые 10 минут",
        every1h:"Каждый час",
        every1d:"Каждый день",
        every1w:"Раз в неделю",
        every1M:"Каждый месяц",
        work:"Работа",
        personal:"Личное",
        study:"Учёба",
        deleteBtn:"Удалить",

        themeSettingsTitle:"Настройка темы",
        labelBodyBgColor:"Цвет фона страницы:",
        labelBodyTextColor:"Цвет текста страницы:",
        labelFieldShape:"Форма полей ввода / списков",
        labelTextInputBg:'Цвет фона поля "Текст напоминания":',
        labelTextInputColor:'Цвет текста поля "Текст напоминания":',
        labelDateInputBg:'Цвет фона поля "Дата":',
        labelDateInputColor:'Цвет текста поля "Дата":',
        labelTimeInputBg:'Цвет фона поля "Время":',
        labelTimeInputColor:'Цвет текста поля "Время":',
        labelCategoryBg:'Цвет фона поля "Категория":',
        labelCategoryColor:'Цвет текста поля "Категория":',
        labelRepeatBg:'Цвет фона поля "Повтор":',
        labelRepeatColor:'Цвет текста поля "Повтор":',
        labelLangBg:'Цвет фона списка "Язык":',
        labelLangColor:'Цвет текста списка "Язык":',

        labelAddBtnBgColor:'Цвет фона кнопки &laquo;Добавить&raquo;:',
        labelAddBtnTextColor:'Цвет текста кнопки &laquo;Добавить&raquo;:',
        labelAddBtnShape:'Форма кнопки &laquo;Добавить&raquo;:',
        labelDeleteBtnBgColor:'Цвет фона кнопки &laquo;Удалить&raquo;:',
        labelDeleteBtnTextColor:'Цвет текста кнопки &laquo;Удалить&raquo;:',
        labelDeleteBtnShape:'Форма кнопки &laquo;Удалить&raquo;:',
        labelThemeBtnBgColor:'Цвет фона кнопки &laquo;Тема&raquo;:',
        labelThemeBtnTextColor:'Цвет текста кнопки &laquo;Тема&raquo;:',
        labelThemeBtnShape:'Форма кнопки &laquo;Тема&raquo;:',

        labelItemBgColor:'Цвет фона "Напоминания":',
        labelItemTextColor:'Цвет текста "Напоминания":',

        whiteThemeButton:"Белая тема",
        blackThemeButton:"Чёрная тема",
        saveCustomTheme:"Применить",
        resetCustomTheme:"Сбросить"
      },
      en: {
        title:"My Reminders",
        placeholderReminder:"Reminder text",
        addBtn:"Add",
        themeBtn:"Theme",
        repeatNone:"No repeat",
        every10m:"Every 10 minutes",
        every1h:"Every hour",
        every1d:"Every day",
        every1w:"Once a week",
        every1M:"Every month",
        work:"Work",
        personal:"Personal",
        study:"Study",
        deleteBtn:"Delete",

        themeSettingsTitle:"Theme Settings",
        labelBodyBgColor:"Page background color:",
        labelBodyTextColor:"Page text color:",
        labelFieldShape:"Fields shape",
        labelTextInputBg:'Bg color of "Reminder text":',
        labelTextInputColor:'Text color of "Reminder text":',
        labelDateInputBg:'Bg color of "Date":',
        labelDateInputColor:'Text color of "Date":',
        labelTimeInputBg:'Bg color of "Time":',
        labelTimeInputColor:'Text color of "Time":',
        labelCategoryBg:'Bg color of "Category":',
        labelCategoryColor:'Text color of "Category":',
        labelRepeatBg:'Bg color of "Repeat":',
        labelRepeatColor:'Text color of "Repeat":',
        labelLangBg:'Bg of "Language":',
        labelLangColor:'Color of "Language":',

        labelAddBtnBgColor:'"Add" button bg:',
        labelAddBtnTextColor:'"Add" button text:',
        labelAddBtnShape:'"Add" button shape:',
        labelDeleteBtnBgColor:'"Delete" button bg:',
        labelDeleteBtnTextColor:'"Delete" button text:',
        labelDeleteBtnShape:'"Delete" button shape:',
        labelThemeBtnBgColor:'"Theme" button bg:',
        labelThemeBtnTextColor:'"Theme" button text:',
        labelThemeBtnShape:'"Theme" button shape:',

        labelItemBgColor:'Reminder background:',
        labelItemTextColor:'Reminder text color:',

        whiteThemeButton:"White theme",
        blackThemeButton:"Black theme",
        saveCustomTheme:"Apply",
        resetCustomTheme:"Reset"
      },
      uk: {
        title:"Мої нагадування",
        placeholderReminder:"Текст нагадування",
        addBtn:"Додати",
        themeBtn:"Тема",
        repeatNone:"Без повтору",
        every10m:"Кожні 10 хвилин",
        every1h:"Щогодини",
        every1d:"Щодня",
        every1w:"Раз на тиждень",
        every1M:"Щомісяця",
        work:"Робота",
        personal:"Особисте",
        study:"Навчання",
        deleteBtn:"Видалити",

        themeSettingsTitle:"Налаштування теми",
        labelBodyBgColor:"Колір фону сторінки:",
        labelBodyTextColor:"Колір тексту сторінки:",
        labelFieldShape:"Форма полів вводу / списків",
        labelTextInputBg:'Фон поля "Текст нагадування":',
        labelTextInputColor:'Текст поля "Текст нагадування":',
        labelDateInputBg:'Фон поля "Дата":',
        labelDateInputColor:'Текст поля "Дата":',
        labelTimeInputBg:'Фон поля "Час":',
        labelTimeInputColor:'Текст поля "Час":',
        labelCategoryBg:'Фон поля "Категорія":',
        labelCategoryColor:'Текст поля "Категорія":',
        labelRepeatBg:'Фон поля "Повтор":',
        labelRepeatColor:'Текст поля "Повтор":',
        labelLangBg:'Фон списку "Мова":',
        labelLangColor:'Колір списку "Мова":',

        labelAddBtnBgColor:'Фон кнопки &laquo;Додати&raquo;:',
        labelAddBtnTextColor:'Текст кнопки &laquo;Додати&raquo;:',
        labelAddBtnShape:'Форма кнопки &laquo;Додати&raquo;:',
        labelDeleteBtnBgColor:'Фон кнопки &laquo;Видалити&raquo;:',
        labelDeleteBtnTextColor:'Текст кнопки &laquo;Видалити&raquo;:',
        labelDeleteBtnShape:'Форма кнопки &laquo;Видалити&raquo;:',
        labelThemeBtnBgColor:'Фон кнопки &laquo;Тема&raquo;:',
        labelThemeBtnTextColor:'Текст кнопки &laquo;Тема&raquo;:',
        labelThemeBtnShape:'Форма кнопки &laquo;Тема&raquo;:',

        labelItemBgColor:'Фон "Нагадування":',
        labelItemTextColor:'Текст "Нагадування":',

        whiteThemeButton:"Біла тема",
        blackThemeButton:"Чорна тема",
        saveCustomTheme:"Застосувати",
        resetCustomTheme:"Скинути"
      }
    };

    function applyTranslations() {
      const t = translations[currentLang] || translations.ru;
      // Заголовок
      document.getElementById('title').textContent = t.title;
      // Placeholder поля &laquo;Текст напоминания&raquo;
      document.getElementById('reminderText').placeholder = t.placeholderReminder;
      // Кнопка &laquo;Добавить&raquo;
      document.getElementById('addReminder').textContent   = t.addBtn;
      // Кнопка &laquo;Тема&raquo;
      document.getElementById('themeToggle').textContent   = t.themeBtn;

      // Список &laquo;Повтор&raquo;
      const repSel=document.getElementById('reminderRepeat');
      repSel.options[0].text=t.repeatNone;
      repSel.options[1].text=t.every10m;
      repSel.options[2].text=t.every1h;
      repSel.options[3].text=t.every1d;
      repSel.options[4].text=t.every1w;
      repSel.options[5].text=t.every1M;

      // Список &laquo;Категория&raquo;
      const catSel=document.getElementById('reminderCategory');
      catSel.options[0].text=t.work;
      catSel.options[1].text=t.personal;
      catSel.options[2].text=t.study;

      // Лейблы панели &laquo;Тема&raquo;
      document.getElementById('themeSettingsTitle').textContent = t.themeSettingsTitle;
      document.getElementById('labelBodyBgColor').firstChild.textContent    = t.labelBodyBgColor+" ";
      document.getElementById('labelBodyTextColor').firstChild.textContent  = t.labelBodyTextColor+" ";
      document.getElementById('labelFieldShape').firstChild.textContent     = t.labelFieldShape+":";

      document.getElementById('labelTextInputBg').firstChild.textContent    = t.labelTextInputBg+" ";
      document.getElementById('labelTextInputColor').firstChild.textContent = t.labelTextInputColor+" ";
      document.getElementById('labelDateInputBg').firstChild.textContent    = t.labelDateInputBg+" ";
      document.getElementById('labelDateInputColor').firstChild.textContent = t.labelDateInputColor+" ";
      document.getElementById('labelTimeInputBg').firstChild.textContent    = t.labelTimeInputBg+" ";
      document.getElementById('labelTimeInputColor').firstChild.textContent = t.labelTimeInputColor+" ";
      document.getElementById('labelCategoryBg').firstChild.textContent     = t.labelCategoryBg+" ";
      document.getElementById('labelCategoryColor').firstChild.textContent  = t.labelCategoryColor+" ";
      document.getElementById('labelRepeatBg').firstChild.textContent       = t.labelRepeatBg+" ";
      document.getElementById('labelRepeatColor').firstChild.textContent    = t.labelRepeatColor+" ";
      document.getElementById('labelLangBg').firstChild.textContent         = t.labelLangBg+" ";
      document.getElementById('labelLangColor').firstChild.textContent      = t.labelLangColor+" ";

      document.getElementById('labelAddBtnBgColor').firstChild.textContent     = t.labelAddBtnBgColor+" ";
      document.getElementById('labelAddBtnTextColor').firstChild.textContent   = t.labelAddBtnTextColor+" ";
      document.getElementById('labelAddBtnShape').firstChild.textContent       = t.labelAddBtnShape+":";

      document.getElementById('labelDeleteBtnBgColor').firstChild.textContent  = t.labelDeleteBtnBgColor+" ";
      document.getElementById('labelDeleteBtnTextColor').firstChild.textContent= t.labelDeleteBtnTextColor+" ";
      document.getElementById('labelDeleteBtnShape').firstChild.textContent    = t.labelDeleteBtnShape+":";

      document.getElementById('labelThemeBtnBgColor').firstChild.textContent   = t.labelThemeBtnBgColor+" ";
      document.getElementById('labelThemeBtnTextColor').firstChild.textContent = t.labelThemeBtnTextColor+" ";
      document.getElementById('labelThemeBtnShape').firstChild.textContent     = t.labelThemeBtnShape+":";

      document.getElementById('labelItemBgColor').firstChild.textContent       = t.labelItemBgColor+" ";
      document.getElementById('labelItemTextColor').firstChild.textContent     = t.labelItemTextColor+" ";

      document.getElementById('whiteThemeButton').textContent = t.whiteThemeButton;
      document.getElementById('blackThemeButton').textContent = t.blackThemeButton;
      document.getElementById('saveCustomTheme').textContent  = t.saveCustomTheme;
      document.getElementById('resetCustomTheme').textContent = t.resetCustomTheme;

      // Перерисовать категории (чтобы &laquo;Удалить&raquo; / &laquo;Delete&raquo; поменялось)
      renderCategories();
    }

    /* ======================
       2) ПРИМЕНЕНИЕ НАСТРОЕК (body, поля, кнопки, .reminder-item)
       ...
       (как в предыдущих примерах)
    ====================== */

    // ====== 3) ИНИЦИАЛИЗАЦИЯ ПОЛЕЙ, 4) ПРЕСЕТЫ, 5) ПОКАЗ/СКРЫТИЕ ПАНЕЛИ, 6) НАПОМИНАНИЯ, 7) КАТЕГОРИИ, 8) ДОБАВЛЕНИЕ - см. предыдущие примеры

    /* =================================
       9) ПРИ ЗАГРУЗКЕ: ЗАПУСК
    ================================= */
    document.addEventListener('DOMContentLoaded',()=>{
      if("Notification" in window){
        if(Notification.permission==="default"){
          Notification.requestPermission();
        }
      }
    });

    // Выставляем язык из localStorage
    const langSel=document.getElementById('languageSelect');
    langSel.value=currentLang;
    langSel.addEventListener('change', e=>{
      currentLang=e.target.value;
      localStorage.setItem('language', currentLang);
      applyTranslations(); // <-- при смене языка вызываем applyTranslations()
    });

    // Финальный запуск
    applyTranslations();   // Применяем переводы (в соответствии с currentLang)
    initColorPickers();    // Заполняем color-инпуты
    applyCustomColors();   // Применяем цвета к элементам
    renderCategories();    // Рисуем список категорий
    resetAllTimers();      // Запускаем таймеры напоминаний
  </script>
</body>
</html>
